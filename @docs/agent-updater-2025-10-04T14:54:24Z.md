# Agent Updater Enhancements — 2025-10-04T14:54:24Z

## What changed
- Refactored `.codex/scripts/codex_pattern_updater.py` to support multi-agent runs, shared Claude-only LLM discovery, and generalized markdown rendering with manual reminder preservation for Claude.
- Added `.claude/automation_state.json` tracking and re-rendered `.claude/CLAUDE.md` into the same structured guideline format used by Codex while keeping the original manual bullets under a marker block.
- Updated `.codex/scripts/run_codex_update.sh` to process both Codex and Claude histories via a single cron invocation with explicit path overrides.

## How to verify
- Run `CODEX_PATTERN_DISABLE_LLM=1 python3 .codex/scripts/codex_pattern_updater.py --agent all --skip-git \
    --codex-state /home/prei/dotfiles/.codex/automation_state.json \
    --codex-output /home/prei/dotfiles/.codex/AGENTS.md \
    --codex-history /home/prei/.codex/history.jsonl \
    --claude-state /home/prei/dotfiles/.claude/automation_state.json \
    --claude-output /home/prei/dotfiles/.claude/CLAUDE.md \
    --claude-projects /home/prei/.claude/projects \
    --claude-history /home/prei/.claude/history.jsonl` to regenerate guidance without touching git.
- Inspect `.claude/CLAUDE.md` and `.codex/AGENTS.md` to confirm pattern counts update and that the manual marker block still contains the hand-authored reminders.
- Review `.claude/automation_state.json` for the new processed session ledger mirroring the Codex automation state.

## Update — 2025-10-04T15:04:34Z
- Strip ANSI escape codes and other control characters when ingesting history so rendered guidance stays ASCII-only (fixes the "Γ" artifacts in `.claude/CLAUDE.md`).
- Re-ran the updater to refresh `.claude/CLAUDE.md`, `.codex/AGENTS.md`, and the automation state files with the sanitized snippets.
